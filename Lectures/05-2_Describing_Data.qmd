---
title: "Measures of Central Tendency"
author:
  - Elizabeth King
  - Kevin Middleton
format:
  revealjs:
    theme: [default, custom.scss]
    standalone: true
    self-contained: true
    logo: QMLS_Logo.png
    slide-number: true
    show-slide-number: all
code-annotations: hover
bibliography: QMLS_Bibliography.bib
csl: evolution.csl
---

<!--
Datasets
  Stickleback_Plates.csv
-->

Pull 6-1 over (minus CI)
In order to build models, we need to summarize data 
- to do what we just did, we needed to define a mean and sd - model a difference
- focus on uncertainty and describing uncertainty

Mention mean for proportions - or first slide of 5-3




## Measures of central tendency (location)

```{r}
#| label: setup
#| message: false
#| warning: false

library(tidyverse)
library(cowplot)

theme_set(theme_cowplot())
```

The value around which the distribution is centered

1. Mean 
1. Median
1. Mode (most common value)


## Sample (arithmetic) mean

$$\bar{Y} = \frac{\sum^n_{i=1}Y_i}{n}$$

The term "mean" is preferred to "average". 

- The arithmetic mean is one kind of average, but there are others (as there are other types of means).
- One argument: "Average" is a statistic determined by an arithmetic procedure. "Mean" is a parameter describing a sample.


## Median

- The median is the central measurement of a sample (the 50th percentile and the 0.50 quantile).
- If $n$ is even, then the median is the mean of the two middle observations.

```{r}
#| echo: true

1:10
median(1:10)
quantile(1:10, prob = 0.5)
```


## Mean vs. Median

Number of lateral plates (plates) in threespine sticklebacks (*Gasterosteus aculeatus*) with three different *Ectodysplasin* genotypes (*mm*, *Mm*, and *MM*).

![](https://i.imgur.com/Xr68AKa.jpg){fig-align="center"}


## Mean vs. Median

```{r}
SticklebackPlates <- read_csv("../data/Stickleback_Plates.csv",
                              show_col_types = FALSE)
```

```{r}
#| echo: true

glimpse(SticklebackPlates)
```


## Mean vs. Median

```{r}
ggplot(SticklebackPlates, aes(x = plates)) +
  geom_histogram(bins = 30, fill = "gray75") +
  facet_grid(genotype ~ .) +
  labs(x = "Number of Lateral Body Plates", y = "Count") +
  theme(strip.text = element_text(face = "italic"))
```


## Mean vs. Median

```{r}
#| echo: true

SticklebackPlates |> 
  summarize(mean_plate = mean(plates),
            median_plate = median(plates),
            .by = genotype)
```


## Mean is sensitive to extreme values

```{r}
M <- SticklebackPlates |> 
  group_by(genotype) |> 
  summarize(Mean = mean(plates),
            Median = median(plates),
            .groups = "drop") |> 
  gather(Value, x, -genotype)

ggplot(SticklebackPlates, aes(x = plates, group = genotype)) +
  geom_histogram(bins = 30, fill = "gray75") +
  geom_vline(data = M, aes(xintercept = x, color = Value),
             linewidth = 2) +
  scale_color_manual(values = c("firebrick4", "navyblue")) +
  facet_grid(genotype ~ .) +
  labs(x = "Number of Lateral Body Plates", y = "Count") +
  theme(strip.text = element_text(face = "italic"))
```


## Mean, median, and mode

```{r}
set.seed(3246788)

mode <- function(x) {
  dd <- density(x)
  dd$x[which.max(dd$y)]
}

DD <- tibble(y = rnorm(500, 10, 1))
DD_mmm <- DD |> 
  summarize(Mean = mean(y),
            Median = median(y),
            Mode = mode(y)) |> 
  pivot_longer(cols = everything())

ggplot() +
  geom_histogram(data = DD, aes(y), bins = 30, fill = "gray75") +
  geom_vline(data = DD_mmm, aes(xintercept = value, color = name),
             linewidth = 2) +
  scale_color_manual(name = "Measure", values = c("firebrick4", "navyblue", "mediumorchid")) +
  labs(y = "Count")

```


## Mean, median, and mode

```{r}
set.seed(3246788)

DD <- tibble(y = c(rlnorm(250, 2, 1), runif(250, 50, 250)))
DD_mmm <- DD |> 
  summarize(Mean = mean(y),
            Median = median(y),
            Mode = mode(y)) |> 
  pivot_longer(cols = everything())

ggplot() +
  geom_histogram(data = DD, aes(y), bins = 30, fill = "gray75") +
  geom_vline(data = DD_mmm, aes(xintercept = value, color = name),
             linewidth = 2) +
  scale_color_manual(name = "Measure", values = c("firebrick4", "navyblue", "mediumorchid")) +
  labs(y = "Count")

```


## Outstanding questions

1. When might you substitute the median for the mean?
1. Why don't we always use the median?
1. When would you use the mode?

